(this["webpackJsonpmitmhub-gui"]=this["webpackJsonpmitmhub-gui"]||[]).push([[0],{175:function(e,t,a){e.exports=a(346)},180:function(e,t,a){},181:function(e,t,a){},182:function(e,t,a){},187:function(e,t,a){},188:function(e,t,a){},189:function(e,t,a){},250:function(e,t,a){},251:function(e,t,a){},344:function(e,t,a){},345:function(e,t,a){},346:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(6),o=a.n(s),c=a(48),i=a(41),l=a(168),u=(a(180),a(22)),p=a(23),m=a(24),h=a(25),d=(a(181),a(182),function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"title"},r.a.createElement("strong",null,"MITM"),r.a.createElement("em",null,"hub"))}}]),a}(n.Component)),f=window.require("electron").ipcRenderer,v=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"componentDidMount",value:function(){JSON.parse(f.sendSync("init","hello, world")).installed?this.props.history.push("/app"):this.props.history.push("/setup")}},{key:"render",value:function(){return r.a.createElement("div",{className:"appContainer"},r.a.createElement(d,null))}}]),a}(n.Component),g=Object(i.f)(v),y=a(125),E=(a(187),a(126)),_=a(352),b=a(32),O=a(93),N=a(353),j=a(63),k=a(51),S=a(351),w=(a(188),a(189),a(60));function C(){return fetch("http://localhost:9846/api/network")}function R(e){var t={node_id:e};return fetch("http://localhost:9846/api/fill_tags",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)})}function x(e){var t={node_id:e};return fetch("http://localhost:9846/api/start_mitm",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)})}function T(e){var t={node_id:e};return fetch("http://localhost:9846/api/stop_mitm",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)})}var P=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).state={nodes:[],selected_node:null},e.menu=r.a.createElement(E.a,{className:"menu"},r.a.createElement(E.a.Item,{key:"0",className:"menu-text",onClick:function(t){_.a.open({message:"Getting tags"}),R(e.state.selected_node).then((function(e){return e.json()})).then((function(t){_.a.open({message:t.status}),e.refreshNodes()})).catch((function(t){_.a.open({message:"Error: "+t}),e.refreshNodes()}))}},"get tags"),r.a.createElement(E.a.Item,{key:"1",className:"menu-text",onClick:function(t){_.a.open({message:"Starting mitm"}),x(e.state.selected_node).then((function(e){return e.json()})).then((function(t){_.a.open({message:t.status}),e.refreshNodes()})).catch((function(t){_.a.open({message:"Error: "+t}),e.refreshNodes()}))}},"start mitm"),r.a.createElement(E.a.Item,{key:"3",className:"menu-text",onClick:function(t){_.a.open({message:"Stopping mitm"}),T(e.state.selected_node).then((function(e){return e.json()})).then((function(t){_.a.open({message:t.status}),e.refreshNodes()})).catch((function(t){_.a.open({message:"Error: "+t}),e.refreshNodes()}))}},"stop mitm")),e}return Object(p.a)(a,[{key:"refreshNodes",value:function(){var e=this;C().then((function(e){return e.json()})).then((function(t){return e.setState({nodes:t.network_nodes})})).catch((function(t){e.setState({nodes:[]})}))}},{key:"componentDidMount",value:function(){this.refreshNodes()}},{key:"_addTagsToNode",value:function(e,t){var a=this.state.nodes;for(var n in a){var r=a[n];if(r.mac===e)return r.tags=t,void this.setState({nodes:a})}}},{key:"_generateTagDivs",value:function(e){var t=[];for(var a in e){var n=e[a];n instanceof Array&&(n=n[0]),t.push(r.a.createElement("div",null,a,": ",n))}return t}},{key:"_generateCard",value:function(e){var t=this;return r.a.createElement(b.a,{span:8},r.a.createElement(O.a,{overlay:this.menu,trigger:["click"]},r.a.createElement(N.a,{bordered:!1,style:{backgroundColor:"#424242",marginBottom:"2vh"},className:"card-text",onClick:function(a){a.preventDefault(),t.setState({selected_node:e.mac})}},r.a.createElement("div",null,r.a.createElement("strong",null,e.mac," / ",e.ip)," ",e.is_mitm_running&&r.a.createElement(S.a,{spin:!0})),r.a.createElement("hr",{className:"hrChange"}),this._generateTagDivs(e.tags))))}},{key:"_generateRow",value:function(e){return r.a.createElement(j.a,{gutter:16},e[0],e[1],e[2])}},{key:"_generateGrid",value:function(){var e=[],t=[],a=this.state.nodes;for(var n in a)t.push(this._generateCard(a[n])),(n+1)%3===0&&(e.push(this._generateRow(t)),t=[]);return t&&e.push(this._generateRow(t)),e}},{key:"chooseRender",value:function(){return this.state.nodes.length?r.a.createElement("div",null,this._generateGrid()):(this.refreshNodes(),r.a.createElement(l.a,{size:"large"}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"site-card-wrapper"},this.chooseRender(),r.a.createElement("br",null),r.a.createElement(k.a,{type:"primary",size:"default",onClick:function(t){_.a.open({message:"Refreshing network"}),fetch("http://localhost:9846/api/refresh").then((function(e){return e.json()})).then((function(t){_.a.open({message:t.status}),e.refreshNodes()})).catch((function(t){e.setState({nodes:[]}),_.a.open({message:"Error: "+t})}))}},"refresh"))}}]),a}(n.Component),J=a(123),A=a(94),D=(a(250),a(72)),I=a(350),K=a(349),M=(a(251),[{title:"Rule Name",dataIndex:"name",key:"name"},{title:"Params",dataIndex:"params",key:"params"}]),z=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={selectedRowKeys:null,data:[]},e.onSelectChange=function(t){e.setState({selectedRowKeys:t})},e}return Object(p.a)(a,[{key:"componentDidUpdate",value:function(){var e=this;(function(e){var t={node_id:e};return fetch("http://localhost:9846/api/get_running_rules",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)})})(this.props.mac).then((function(e){return e.json()})).then((function(t){var a=t.response,n=[];for(var r in a)n.push({key:r,index:r,name:a[r].filter_name,params:JSON.stringify(a[r].filter_args)});JSON.stringify(n)!==JSON.stringify(e.state.data)&&e.setState({data:n})}))}},{key:"removeDeletedRule",value:function(e){var t=this.state.data,a=-1;for(var n in t)if(t[n].key===e){a=n;break}a&&(t.splice(a,1),this.setState({data:t}))}},{key:"render",value:function(){var e=this,t={selectedRowKeys:this.state.selectedRowKeys,onChange:this.onSelectChange};return r.a.createElement("div",{className:"table-container"},r.a.createElement(k.a,{type:"primary",size:"large",onClick:function(t){e.state.selectedRowKeys?function(e,t){var a={node_id:e,request:{filter_index:t}};return fetch("http://localhost:9846/api/remove_rule",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)})}(e.props.mac,e.state.selectedRowKeys[0]).then((function(e){return e.json()})).then((function(t){e.removeDeletedRule(e.state.selectedRowKeys[0]),_.a.open({message:t.status})})):_.a.open({message:"Select rule to delete"})}},"Delete"),r.a.createElement(K.a,{rowSelection:t,dataSource:this.state.data,columns:M}))}}]),a}(n.Component),q=D.a.Option,G=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(u.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={mac_list:[],selected_node:null,rule_options:null,selected_rule:"Pick rule",params:null},e._updateSelectedNodeAndGetRuleOptions=function(t){e.setState(t,(function(){e._fetchRuleOptions()}))},e}return Object(p.a)(a,[{key:"resetState",value:function(){this.setState({mac_list:[],selected_node:null,rule_options:null,selected_rule:"Pick rule",params:null})}},{key:"refreshNodes",value:function(){var e=this;C().then((function(e){return e.json()})).then((function(t){var a,n=t.network_nodes,r=[],s=Object(A.a)(n);try{for(s.s();!(a=s.n()).done;){var o=a.value;r.push(o.mac)}}catch(c){s.e(c)}finally{s.f()}JSON.stringify(e.state.mac_list)!==JSON.stringify(r)&&e.setState({mac_list:r})})).catch((function(t){e.resetState()}))}},{key:"componentDidMount",value:function(){this.refreshNodes()}},{key:"_fetchRuleOptions",value:function(){var e=this;(function(e){var t={node_id:e};return fetch("http://localhost:9846/api/get_rules",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)})})(this.state.selected_node).then((function(e){return e.json()})).then((function(t){JSON.stringify(e.state.rule_options)!==JSON.stringify(t.response)&&e.setState({rule_options:t.response})})).catch((function(t){e.resetState()}))}},{key:"_generateNodeOptions",value:function(){var e,t=[],a=Object(A.a)(this.state.mac_list);try{for(a.s();!(e=a.n()).done;){var n=e.value;t.push(r.a.createElement(q,{value:n,className:"menu-text"},n))}}catch(s){a.e(s)}finally{a.f()}return t}},{key:"_generateRuleOptions",value:function(){if(this.state.selected_node&&this.state.rule_options){var e=[];for(var t in this.state.rule_options)e.push(r.a.createElement(q,{value:t,className:"menu-text"},t));return e}return[]}},{key:"_generateParamInput",value:function(){var e=this;if("Pick rule"!==this.state.selected_rule){var t=[],a=this.state.rule_options[this.state.selected_rule].param_explanation;t.push(r.a.createElement("div",{className:"param-desc"},a));var n,s=Object(A.a)(this.state.rule_options[this.state.selected_rule].filter_params);try{var o=function(){var a=n.value;t.push(r.a.createElement("div",null,r.a.createElement("div",{className:"param-title"},a),r.a.createElement(I.a,{onChange:function(t){return e.setState(Object(J.a)({},e.state,{params:Object(J.a)({},e.state.params,Object(w.a)({},a,t.target.value))}))}}),r.a.createElement("br",null)))};for(s.s();!(n=s.n()).done;)o()}catch(c){s.e(c)}finally{s.f()}return t}}},{key:"chooseRender",value:function(){var e=this;return this.refreshNodes(),this.state.mac_list.length?r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"subtitle"},"Node and Rule"),r.a.createElement(D.a,{defaultValue:"Pick node",style:{width:200,marginRight:"1vh"},showSearch:!0,onFocus:function(t){return e.refreshNodes()},onChange:function(t){e._updateSelectedNodeAndGetRuleOptions({selected_node:t,rule_options:null,selected_rule:"Pick rule"})}},this._generateNodeOptions()),r.a.createElement(D.a,{style:{width:200},value:this.state.selected_rule,showSearch:!0,onFocus:function(t){return e._fetchRuleOptions()},onChange:function(t){return e.setState({selected_rule:t})}},this._generateRuleOptions()),r.a.createElement("div",{className:"subtitle"},"Rule Params"),this._generateParamInput(),r.a.createElement("div",{className:"submit-div"},r.a.createElement(k.a,{type:"primary",shape:"round",size:"large",onClick:function(t){e.state.selected_rule&&e.state.params?function(e,t,a){var n={node_id:e,request:Object(w.a)({},t,a)};return fetch("http://localhost:9846/api/set_rule",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)})}(e.state.selected_node,e.state.selected_rule,e.state.params).then((function(e){return e.json()})).then((function(t){"Successfully added rule"===t.status&&e.setState({rule_options:{},selected_rule:"Pick rule"}),_.a.open({message:t.status})})):_.a.open({message:"Please pick rule and fill params"})}},"add rule")),r.a.createElement(z,{mac:this.state.selected_node})):r.a.createElement("div",{className:"container"},r.a.createElement(l.a,{size:"large"}))}},{key:"render",value:function(){return this.chooseRender()}}]),a}(n.Component),B=y.a.TabPane,F=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"render",value:function(){return r.a.createElement(y.a,{defaultActiveKey:"1",className:"tabs"},r.a.createElement(B,{tab:"Network",key:"1"},r.a.createElement(P,null)),r.a.createElement(B,{tab:"Rule Management",key:"2"},r.a.createElement(G,null)))}}]),a}(n.Component),W=(a(344),window.require("electron").ipcRenderer),L=function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"componentDidMount",value:function(){"Success"==JSON.parse(W.sendSync("setup",this.props.os)).status?this.props.history.push("/app"):this.props.history.push("/setup")}},{key:"chooseWarningMessage",value:function(){return"osx"==this.props.os?"you must have brew, python and pip installed":"you must have apt-get, python and pip installed"}},{key:"render",value:function(){return r.a.createElement("div",{className:"install-container"},r.a.createElement(l.a,{size:"large"}),r.a.createElement("span",{className:"install-text"},"installing requirements..."),r.a.createElement("br",null),r.a.createElement("span",{className:"install-warning"},this.chooseWarningMessage()))}}]),a}(n.Component),U=Object(i.f)(L),V=(a(345),function(e){Object(h.a)(a,e);var t=Object(m.a)(a);function a(){return Object(u.a)(this,a),t.apply(this,arguments)}return Object(p.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"site-card-wrapper"},r.a.createElement(j.a,{gutter:16},r.a.createElement(b.a,{span:12},r.a.createElement(c.b,{to:"/osx-setup"},r.a.createElement(N.a,{bordered:!1,style:{backgroundColor:"#424242"}},r.a.createElement("img",{className:"image",src:"https://www.transparentpng.com/download/apple-logo/hRoKDb-apple-logo-transparent.png"}),r.a.createElement("div",{className:"os-title"},"OSX")))),r.a.createElement(b.a,{span:12},r.a.createElement(c.b,{to:"/linux-setup"},r.a.createElement(N.a,{bordered:!1,style:{backgroundColor:"#424242"}},r.a.createElement("img",{className:"image",src:"https://www.transparentpng.com/download/penguin/grap6l-penguin-hd-image.png"}),r.a.createElement("div",{className:"os-title"},"Linux"))))))}}]),a}(n.Component));o.a.render(r.a.createElement(c.a,null,r.a.createElement(g,null),r.a.createElement("div",null,r.a.createElement(i.c,null,r.a.createElement(i.a,{exact:!0,path:"/"},r.a.createElement(l.a,{size:"large"})),r.a.createElement(i.a,{path:"/setup"},r.a.createElement(V,null)),r.a.createElement(i.a,{path:"/osx-setup"},r.a.createElement(U,{os:"osx"})),r.a.createElement(i.a,{path:"/linux-setup"},r.a.createElement(U,{os:"linux"})),r.a.createElement(i.a,{path:"/app"},r.a.createElement(F,null))))),document.getElementById("root"))}},[[175,1,2]]]);
//# sourceMappingURL=main.d413ee2f.chunk.js.map