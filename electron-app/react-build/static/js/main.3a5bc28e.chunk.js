(this["webpackJsonpmitmhub-gui"]=this["webpackJsonpmitmhub-gui"]||[]).push([[0],{175:function(e,t,n){e.exports=n(346)},180:function(e,t,n){},181:function(e,t,n){},182:function(e,t,n){},187:function(e,t,n){},188:function(e,t,n){},189:function(e,t,n){},250:function(e,t,n){},251:function(e,t,n){},344:function(e,t,n){},345:function(e,t,n){},346:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),s=n(6),o=n.n(s),c=n(48),i=n(41),l=n(168),u=(n(180),n(22)),p=n(23),m=n(24),h=n(25),d=(n(181),n(182),function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{className:"title"},r.a.createElement("strong",null,"MITM"),r.a.createElement("em",null,"hub"))}}]),n}(a.Component)),f=window.require("electron").ipcRenderer,v=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"componentDidMount",value:function(){var e=this;f.send("init","hello, world"),f.on("asynReply",(function(t,n){JSON.parse(n).installed?e.props.history.push("/app"):e.props.history.push("/setup")}))}},{key:"render",value:function(){return r.a.createElement("div",{className:"appContainer"},r.a.createElement(d,null))}}]),n}(a.Component),g=Object(i.f)(v),y=n(125),E=(n(187),n(126)),_=n(352),b=n(32),O=n(93),N=n(353),j=n(63),k=n(51),S=n(351),w=(n(188),n(189),n(60));function C(){return fetch("http://localhost:9846/api/network")}function R(e){var t={node_id:e};return fetch("http://localhost:9846/api/fill_tags",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)})}function x(e){var t={node_id:e};return fetch("http://localhost:9846/api/start_mitm",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)})}function T(e){var t={node_id:e};return fetch("http://localhost:9846/api/stop_mitm",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)})}var P=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(u.a)(this,n);for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return(e=t.call.apply(t,[this].concat(s))).state={nodes:[],selected_node:null},e.menu=r.a.createElement(E.a,{className:"menu"},r.a.createElement(E.a.Item,{key:"0",className:"menu-text",onClick:function(t){_.a.open({message:"Getting tags"}),R(e.state.selected_node).then((function(e){return e.json()})).then((function(t){_.a.open({message:t.status}),e.refreshNodes()})).catch((function(t){_.a.open({message:"Error: "+t}),e.refreshNodes()}))}},"get tags"),r.a.createElement(E.a.Item,{key:"1",className:"menu-text",onClick:function(t){_.a.open({message:"Starting mitm"}),x(e.state.selected_node).then((function(e){return e.json()})).then((function(t){_.a.open({message:t.status}),e.refreshNodes()})).catch((function(t){_.a.open({message:"Error: "+t}),e.refreshNodes()}))}},"start mitm"),r.a.createElement(E.a.Item,{key:"3",className:"menu-text",onClick:function(t){_.a.open({message:"Stopping mitm"}),T(e.state.selected_node).then((function(e){return e.json()})).then((function(t){_.a.open({message:t.status}),e.refreshNodes()})).catch((function(t){_.a.open({message:"Error: "+t}),e.refreshNodes()}))}},"stop mitm")),e}return Object(p.a)(n,[{key:"refreshNodes",value:function(){var e=this;C().then((function(e){return e.json()})).then((function(t){return e.setState({nodes:t.network_nodes})})).catch((function(t){e.setState({nodes:[]})}))}},{key:"componentDidMount",value:function(){this.refreshNodes()}},{key:"_addTagsToNode",value:function(e,t){var n=this.state.nodes;for(var a in n){var r=n[a];if(r.mac===e)return r.tags=t,void this.setState({nodes:n})}}},{key:"_generateTagDivs",value:function(e){var t=[];for(var n in e){var a=e[n];a instanceof Array&&(a=a[0]),t.push(r.a.createElement("div",null,n,": ",a))}return t}},{key:"_generateCard",value:function(e){var t=this;return r.a.createElement(b.a,{span:8},r.a.createElement(O.a,{overlay:this.menu,trigger:["click"]},r.a.createElement(N.a,{bordered:!1,style:{backgroundColor:"#424242",marginBottom:"2vh"},className:"card-text",onClick:function(n){n.preventDefault(),t.setState({selected_node:e.mac})}},r.a.createElement("div",null,r.a.createElement("strong",null,e.mac," / ",e.ip)," ",e.is_mitm_running&&r.a.createElement(S.a,{spin:!0})),r.a.createElement("hr",{className:"hrChange"}),this._generateTagDivs(e.tags))))}},{key:"_generateRow",value:function(e){return r.a.createElement(j.a,{gutter:16},e[0],e[1],e[2])}},{key:"_generateGrid",value:function(){var e=[],t=[],n=this.state.nodes;for(var a in n)t.push(this._generateCard(n[a])),(a+1)%3===0&&(e.push(this._generateRow(t)),t=[]);return t&&e.push(this._generateRow(t)),e}},{key:"chooseRender",value:function(){return this.state.nodes.length?r.a.createElement("div",null,this._generateGrid()):(this.refreshNodes(),r.a.createElement(l.a,{size:"large"}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"site-card-wrapper"},this.chooseRender(),r.a.createElement("br",null),r.a.createElement(k.a,{type:"primary",size:"default",onClick:function(t){_.a.open({message:"Refreshing network"}),fetch("http://localhost:9846/api/refresh").then((function(e){return e.json()})).then((function(t){_.a.open({message:t.status}),e.refreshNodes()})).catch((function(t){e.setState({nodes:[]}),_.a.open({message:"Error: "+t})}))}},"refresh"))}}]),n}(a.Component),J=n(123),A=n(94),D=(n(250),n(72)),I=n(350),K=n(349),M=(n(251),[{title:"Rule Name",dataIndex:"name",key:"name"},{title:"Params",dataIndex:"params",key:"params"}]),z=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(u.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={selectedRowKeys:null,data:[]},e.onSelectChange=function(t){e.setState({selectedRowKeys:t})},e}return Object(p.a)(n,[{key:"componentDidUpdate",value:function(){var e=this;(function(e){var t={node_id:e};return fetch("http://localhost:9846/api/get_running_rules",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)})})(this.props.mac).then((function(e){return e.json()})).then((function(t){var n=t.response,a=[];for(var r in n)a.push({key:r,index:r,name:n[r].filter_name,params:JSON.stringify(n[r].filter_args)});JSON.stringify(a)!==JSON.stringify(e.state.data)&&e.setState({data:a})}))}},{key:"removeDeletedRule",value:function(e){var t=this.state.data,n=-1;for(var a in t)if(t[a].key===e){n=a;break}n&&(t.splice(n,1),this.setState({data:t}))}},{key:"render",value:function(){var e=this,t={selectedRowKeys:this.state.selectedRowKeys,onChange:this.onSelectChange};return r.a.createElement("div",{className:"table-container"},r.a.createElement(k.a,{type:"primary",size:"large",onClick:function(t){e.state.selectedRowKeys?function(e,t){var n={node_id:e,request:{filter_index:t}};return fetch("http://localhost:9846/api/remove_rule",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(n)})}(e.props.mac,e.state.selectedRowKeys[0]).then((function(e){return e.json()})).then((function(t){e.removeDeletedRule(e.state.selectedRowKeys[0]),_.a.open({message:t.status})})):_.a.open({message:"Select rule to delete"})}},"Delete"),r.a.createElement(K.a,{rowSelection:t,dataSource:this.state.data,columns:M}))}}]),n}(a.Component),q=D.a.Option,G=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(u.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={mac_list:[],selected_node:null,rule_options:null,selected_rule:"Pick rule",params:null},e._updateSelectedNodeAndGetRuleOptions=function(t){e.setState(t,(function(){e._fetchRuleOptions()}))},e}return Object(p.a)(n,[{key:"resetState",value:function(){this.setState({mac_list:[],selected_node:null,rule_options:null,selected_rule:"Pick rule",params:null})}},{key:"refreshNodes",value:function(){var e=this;C().then((function(e){return e.json()})).then((function(t){var n,a=t.network_nodes,r=[],s=Object(A.a)(a);try{for(s.s();!(n=s.n()).done;){var o=n.value;r.push(o.mac)}}catch(c){s.e(c)}finally{s.f()}JSON.stringify(e.state.mac_list)!==JSON.stringify(r)&&e.setState({mac_list:r})})).catch((function(t){e.resetState()}))}},{key:"componentDidMount",value:function(){this.refreshNodes()}},{key:"_fetchRuleOptions",value:function(){var e=this;(function(e){var t={node_id:e};return fetch("http://localhost:9846/api/get_rules",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)})})(this.state.selected_node).then((function(e){return e.json()})).then((function(t){JSON.stringify(e.state.rule_options)!==JSON.stringify(t.response)&&e.setState({rule_options:t.response})})).catch((function(t){e.resetState()}))}},{key:"_generateNodeOptions",value:function(){var e,t=[],n=Object(A.a)(this.state.mac_list);try{for(n.s();!(e=n.n()).done;){var a=e.value;t.push(r.a.createElement(q,{value:a,className:"menu-text"},a))}}catch(s){n.e(s)}finally{n.f()}return t}},{key:"_generateRuleOptions",value:function(){if(this.state.selected_node&&this.state.rule_options){var e=[];for(var t in this.state.rule_options)e.push(r.a.createElement(q,{value:t,className:"menu-text"},t));return e}return[]}},{key:"_generateParamInput",value:function(){var e=this;if("Pick rule"!==this.state.selected_rule){var t=[],n=this.state.rule_options[this.state.selected_rule].param_explanation;t.push(r.a.createElement("div",{className:"param-desc"},n));var a,s=Object(A.a)(this.state.rule_options[this.state.selected_rule].filter_params);try{var o=function(){var n=a.value;t.push(r.a.createElement("div",null,r.a.createElement("div",{className:"param-title"},n),r.a.createElement(I.a,{onChange:function(t){return e.setState(Object(J.a)({},e.state,{params:Object(J.a)({},e.state.params,Object(w.a)({},n,t.target.value))}))}}),r.a.createElement("br",null)))};for(s.s();!(a=s.n()).done;)o()}catch(c){s.e(c)}finally{s.f()}return t}}},{key:"chooseRender",value:function(){var e=this;return this.refreshNodes(),this.state.mac_list.length?r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"subtitle"},"Node and Rule"),r.a.createElement(D.a,{defaultValue:"Pick node",style:{width:200,marginRight:"1vh"},showSearch:!0,onFocus:function(t){return e.refreshNodes()},onChange:function(t){e._updateSelectedNodeAndGetRuleOptions({selected_node:t,rule_options:null,selected_rule:"Pick rule"})}},this._generateNodeOptions()),r.a.createElement(D.a,{style:{width:200},value:this.state.selected_rule,showSearch:!0,onFocus:function(t){return e._fetchRuleOptions()},onChange:function(t){return e.setState({selected_rule:t})}},this._generateRuleOptions()),r.a.createElement("div",{className:"subtitle"},"Rule Params"),this._generateParamInput(),r.a.createElement("div",{className:"submit-div"},r.a.createElement(k.a,{type:"primary",shape:"round",size:"large",onClick:function(t){e.state.selected_rule&&e.state.params?function(e,t,n){var a={node_id:e,request:Object(w.a)({},t,n)};return fetch("http://localhost:9846/api/set_rule",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a)})}(e.state.selected_node,e.state.selected_rule,e.state.params).then((function(e){return e.json()})).then((function(t){"Successfully added rule"===t.status&&e.setState({rule_options:{},selected_rule:"Pick rule"}),_.a.open({message:t.status})})):_.a.open({message:"Please pick rule and fill params"})}},"add rule")),r.a.createElement(z,{mac:this.state.selected_node})):r.a.createElement("div",{className:"container"},r.a.createElement(l.a,{size:"large"}))}},{key:"render",value:function(){return this.chooseRender()}}]),n}(a.Component),B=y.a.TabPane,F=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return r.a.createElement(y.a,{defaultActiveKey:"1",className:"tabs"},r.a.createElement(B,{tab:"Network",key:"1"},r.a.createElement(P,null)),r.a.createElement(B,{tab:"Rule Management",key:"2"},r.a.createElement(G,null)))}}]),n}(a.Component),W=(n(344),window.require("electron").ipcRenderer),L=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"componentDidMount",value:function(){var e=this;console.log("mounted"),W.send("setup",this.props.os),W.on("asynReply",(function(t,n){"Success"==JSON.parse(n).status?e.props.history.push("/app"):e.props.history.push("/setup")}))}},{key:"chooseWarningMessage",value:function(){return"osx"==this.props.os?"you must have brew, python and pip installed":"you must have apt-get, python and pip installed"}},{key:"render",value:function(){return r.a.createElement("div",{className:"install-container"},r.a.createElement(l.a,{size:"large"}),r.a.createElement("span",{className:"install-text"},"installing requirements..."),r.a.createElement("br",null),r.a.createElement("span",{className:"install-warning"},this.chooseWarningMessage()))}}]),n}(a.Component),U=Object(i.f)(L),V=(n(345),function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return r.a.createElement("div",{className:"site-card-wrapper"},r.a.createElement(j.a,{gutter:16},r.a.createElement(b.a,{span:12},r.a.createElement(c.b,{to:"/osx-setup"},r.a.createElement(N.a,{bordered:!1,style:{backgroundColor:"#424242"}},r.a.createElement("img",{className:"image",src:"https://www.transparentpng.com/download/apple-logo/hRoKDb-apple-logo-transparent.png"}),r.a.createElement("div",{className:"os-title"},"OSX")))),r.a.createElement(b.a,{span:12},r.a.createElement(c.b,{to:"/linux-setup"},r.a.createElement(N.a,{bordered:!1,style:{backgroundColor:"#424242"}},r.a.createElement("img",{className:"image",src:"https://www.transparentpng.com/download/penguin/grap6l-penguin-hd-image.png"}),r.a.createElement("div",{className:"os-title"},"Linux"))))))}}]),n}(a.Component));o.a.render(r.a.createElement(c.a,null,r.a.createElement(g,null),r.a.createElement("div",null,r.a.createElement(i.c,null,r.a.createElement(i.a,{exact:!0,path:"/"},r.a.createElement(l.a,{size:"large"})),r.a.createElement(i.a,{path:"/setup"},r.a.createElement(V,null)),r.a.createElement(i.a,{path:"/osx-setup"},r.a.createElement(U,{os:"osx"})),r.a.createElement(i.a,{path:"/linux-setup"},r.a.createElement(U,{os:"linux"})),r.a.createElement(i.a,{path:"/app"},r.a.createElement(F,null))))),document.getElementById("root"))}},[[175,1,2]]]);
//# sourceMappingURL=main.3a5bc28e.chunk.js.map